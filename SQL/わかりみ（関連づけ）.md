 # テーブルの関連  
 
 RDBにおいて、関連とはテーブル間の関連をさす。関連の代表的な種類は、**「一対多（一対N）」** と **「多対多（N対N）」** だ。
 
 ## 一対多  
 
 - 「一対多」とは、**ある一つのデータに複数のデータが結びついてること。** もっと詳しく言えば、テーブルの一つのデータに
 別テーブルの複数のデータが結びついてるということ。
 例えは、Twitterのツイートや、クラスを担任している先生と生徒の関係などがそれに当たる。
 
 - 「一対多」の関係では、**「多」の側のテーブルから、「１」の側のテーブルを参照する。つまり、「多」の側に外部キーを作成し、「１」の
 側の主キーを参照するようにする。**
 
 - もし、上記の説明の主キーと外部キーが逆になったら、例えば、Twitterでユーザーに外部キーがあり、ツイートに主キーが合ったら、ユーザーの
 外部キーをいれるフィールドには、ツイートの数だけデータが入ってしまうので、これはDBにはできない。
 よくわからなかったら、わかりみSQLの図を見てみよう。
 
 ### ツリー構造  
 - 一対多は**ツリー状の構造**となっている。一つのデータの下にそれと対応するデータが複数個並んでいる様子がツリー構造として例えられている。
 
 - **SQLでは、テーブル連結するとツリー上位の要素ほど何度も登場し、ツリー構造の下位になるほど登場回数は少なくなる。**
 何回も登場しているからと言って、「多」の側だと勘違いしないように。  
 
 ## 多対多
 
 - 「多対多」とは、**「一対多」の関係を双方向にしたもの。**これではわかりにくいと思うので、例えると、本と作者の関係は「多対多」に当たる。
 一人の本には複数の作者がいて、一人の作者は複数の本を出している。  
 
 ## 交差テーブル（中間テーブル）  
 
「多対多」の関係は、どちらかに外部キーを作成して、もう片方のテーブルの主キーを参照することができない。  
こういう場合に使うのが、**交差テーブル（中間テーブル）**だ。
 
 中間テーブルに外部キーを作成して、booksテーブルとauthersテーブルの主キーを参照するようにする。交差テーブルでは、複数の値は複数の行に
 格納するため一つの行に複数の値が格納されることはない。  
 
```sql
select b.id as book_id, b.title
      ,a.id as auther_id, a.name
from writings as w
join books b on w.book_id = b.id
join authers a on w.author_id = a.id
order by b.id;
```
データを取り出すときは、テーブルを二回結合させる。  

関連づけは、Railsでもよく使うので覚えたい。

